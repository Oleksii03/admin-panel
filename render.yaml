previews:
  generation: automatic

services:
  - type: web
    name: admin-panel-ws
    runtime: node
    plan: free
    buildCommand: npm ci
    startCommand: node server/socket-server.js
    healthCheckPath: /
    envVars:
      - key: NODE_VERSION
        value: 20

  - type: web
    name: admin-panel-frontend
    runtime: static
    plan: free

    buildCommand:
      VITE_SOCKET_URL=https://${WS_HOST} npm install --no-audit --progress=false && npm run
      build-only
    staticPublishPath: ./dist
    envVars:
      - key: WS_HOST
        fromService:
          name: admin-panel-ws
          type: web
          property: host
      - key: NODE_VERSION
        value: 20
